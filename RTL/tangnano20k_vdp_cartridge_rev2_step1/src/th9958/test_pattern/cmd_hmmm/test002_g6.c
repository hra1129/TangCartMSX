// --------------------------------------------------------------------
//	SCREEN0(W40) Sprite mode1 and left mask test
// ====================================================================
//	Programmed by t.hara
// --------------------------------------------------------------------

#include <stdio.h>
#include <stdlib.h>
#include "v9968.h"

// --------------------------------------------------------------------
unsigned char image[] = {
	0x00, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x00, 
	0x01, 0x15, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x51, 0x10, 
	0x11, 0x55, 0x55, 0x55, 0x55, 0x51, 0x11, 0x15, 0x55, 0x55, 0x55, 0x11, 0x11, 0x55, 0x55, 0x11, 
	0x11, 0x55, 0xff, 0xff, 0x55, 0x51, 0x11, 0x15, 0x55, 0x55, 0x55, 0x51, 0x11, 0x55, 0x55, 0x11, 
	0x11, 0x55, 0xff, 0x55, 0x55, 0x11, 0x22, 0x11, 0x55, 0x55, 0x55, 0x51, 0x11, 0x55, 0x55, 0x11, 
	0x11, 0xff, 0xff, 0x55, 0x55, 0x11, 0x22, 0x11, 0x55, 0x55, 0x55, 0x55, 0x11, 0x55, 0x55, 0x11, 
	0x11, 0x55, 0x55, 0x55, 0x51, 0x12, 0x22, 0x21, 0x15, 0x55, 0x55, 0x55, 0x11, 0x15, 0x55, 0x11, 
	0x11, 0x55, 0x55, 0x55, 0x51, 0x12, 0x22, 0x21, 0x15, 0x55, 0x55, 0x55, 0x11, 0x15, 0x55, 0x11, 
	0x11, 0x55, 0x55, 0x55, 0x11, 0x22, 0x22, 0x22, 0x11, 0x55, 0x55, 0x55, 0x11, 0x11, 0x55, 0x11, 
	0x11, 0x55, 0x55, 0x55, 0x11, 0x11, 0x11, 0x11, 0x11, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x11, 
	0x11, 0x55, 0x55, 0x51, 0x15, 0x55, 0x55, 0x55, 0x51, 0x15, 0x55, 0x55, 0x55, 0x55, 0x55, 0x11, 
	0x11, 0x55, 0x55, 0x51, 0x15, 0x55, 0x55, 0x55, 0x51, 0x15, 0x55, 0x55, 0x55, 0x55, 0x55, 0x11, 
	0x11, 0x55, 0x55, 0x11, 0x55, 0x68, 0x9A, 0xBE, 0x55, 0x11, 0x55, 0x55, 0x55, 0x55, 0x55, 0x11, 
	0x11, 0x55, 0x55, 0x11, 0x55, 0x55, 0x55, 0x55, 0x55, 0x11, 0x55, 0x55, 0x55, 0x55, 0x55, 0x11, 
	0x01, 0x15, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x51, 0x10, 
	0x00, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x00, 
};

// --------------------------------------------------------------------
void cls( void ) {

	v9968_write_vdp( 17, 36 );
	outp( vdp_port3, 0 );		//	DX
	outp( vdp_port3, 0 );
	outp( vdp_port3, 0 );		//	DY
	outp( vdp_port3, 0 );
	outp( vdp_port3, 0 );		//	NX
	outp( vdp_port3, 2 );
	outp( vdp_port3, 0 );		//	NY
	outp( vdp_port3, 1 );
	outp( vdp_port3, 0 );		//	CLR
	outp( vdp_port3, 0 );		//	ARG
	outp( vdp_port3, 0xC0 );	//	CMD
	v9968_wait_vdp_command();
}

// --------------------------------------------------------------------
void v9968_hmmm( unsigned int sx, unsigned int sy, unsigned int dx, unsigned int dy, unsigned int nx, unsigned int ny, unsigned char arg ) {

	v9968_write_vdp( 32, sx & 255 );
	v9968_write_vdp( 33, sx >> 8 );
	v9968_write_vdp( 34, sy & 255 );
	v9968_write_vdp( 35, sy >> 8 );
	v9968_write_vdp( 36, dx & 255 );
	v9968_write_vdp( 37, dx >> 8 );
	v9968_write_vdp( 38, dy & 255 );
	v9968_write_vdp( 39, dy >> 8 );
	v9968_write_vdp( 40, nx & 255 );
	v9968_write_vdp( 41, nx >> 8 );
	v9968_write_vdp( 42, ny & 255 );
	v9968_write_vdp( 43, ny >> 8 );
	v9968_write_vdp( 45, arg );
	v9968_write_vdp( 46, 0xD0 );
	v9968_wait_vdp_command();
}

// --------------------------------------------------------------------
int main( int argc, char *argv[] ) {
	int i, j, p;

	v9968_set_screen7();
	v9968_write_vdp( 7, 0x0C );
	cls();
	v9968_set_write_vram_address( 0, 0 );
	p = 0;
	for( j = 0; j < 16; j++ ) {
		for( i = 0; i < 256; i++ ) {
			outp( vdp_port0, image[ (i & 15) | p ] );
		}
		p += 16;
	}

	for( i = 0; i < 16; i++ ) {
		v9968_hmmm( i << 1, 0, i << 1, 32, 2, i + 1, 0 );
	}

	for( i = 0; i < 16; i++ ) {
		v9968_hmmm( 0, i, 32, 32 + i, (i << 1) + 2, 1, 0 );
	}
	v9968_wait_key();
	v9968_exit();
	return 0;
}
