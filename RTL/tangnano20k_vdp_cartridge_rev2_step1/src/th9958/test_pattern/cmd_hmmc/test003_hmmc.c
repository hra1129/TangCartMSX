// --------------------------------------------------------------------
//	SCREEN0(W40) Sprite mode1 and left mask test
// ====================================================================
//	Programmed by t.hara
// --------------------------------------------------------------------

#include <stdio.h>
#include <stdlib.h>
#include "v9968.h"

#define DIX		4
#define DIY		8

// --------------------------------------------------------------------
unsigned char parts[] = {
	0x11, 0x11, 0x11, 0x00, 0x00, 0x11, 0x11, 0x11,
	0x12, 0x22, 0x21, 0x00, 0x00, 0x1C, 0xCC, 0xC1,
	0x12, 0x11, 0x11, 0x00, 0x00, 0x11, 0x11, 0xC1,
	0x12, 0x10, 0x00, 0x00, 0x00, 0x00, 0x01, 0xC1,
	0x12, 0x10, 0x88, 0xAA, 0xAA, 0x88, 0x01, 0xC1,
	0x12, 0x10, 0x88, 0x8A, 0xA8, 0x88, 0x01, 0xC1,
	0x12, 0x10, 0x88, 0x8A, 0xA8, 0x88, 0x01, 0xC1,
	0x12, 0x10, 0x88, 0x8B, 0xB8, 0x88, 0x01, 0xC1,
	0x12, 0x10, 0x88, 0x8B, 0xB8, 0x88, 0x01, 0xC1,
	0x12, 0x10, 0x88, 0x8F, 0xF8, 0x88, 0x01, 0xC1,
	0x12, 0x10, 0x88, 0x8F, 0xF8, 0x88, 0x01, 0xC1,
	0x12, 0x10, 0x88, 0xFF, 0xFF, 0x88, 0x01, 0xC1,
	0x12, 0x10, 0x00, 0x00, 0x00, 0x00, 0x01, 0xC1,
	0x12, 0x11, 0x11, 0x00, 0x00, 0x11, 0x11, 0xC1,
	0x12, 0x22, 0x21, 0x00, 0x00, 0x1C, 0xCC, 0xC1,
	0x11, 0x11, 0x11, 0x00, 0x00, 0x11, 0x11, 0x11,
};

// --------------------------------------------------------------------
void v9968_hmmc( unsigned int dx, unsigned int dy, unsigned int nx, unsigned int ny, unsigned char arg, unsigned char first ) {

	v9968_write_vdp( 46, 0xA0 );
	v9968_write_vdp( 46, 0x00 );

	v9968_write_vdp( 36, dx & 255 );
	v9968_write_vdp( 37, dx >> 8 );
	v9968_write_vdp( 38, dy & 255 );
	v9968_write_vdp( 39, dy >> 8 );
	v9968_write_vdp( 40, nx & 255 );
	v9968_write_vdp( 41, nx >> 8 );
	v9968_write_vdp( 42, ny & 255 );
	v9968_write_vdp( 43, ny >> 8 );
	v9968_write_vdp( 44, first );
	v9968_write_vdp( 45, arg );
	v9968_write_vdp( 46, 0xF0 );
}

// --------------------------------------------------------------------
int main( int argc, char *argv[] ) {
	int x, y, j;
	unsigned char c;

	v9968_set_screen5();

	v9968_fill_vram( 0x0000, 0, 128 * 212 );

	for( y = 0; y < 12; y++ ) {
		for( x = 0; x < 16; x++ ) {
			v9968_hmmc( x * 16, y * 16, 16, 16, 0, parts[0] );
			for( j = 1; j < 8 * 16; j++ ) {
				do {
					c = v9968_read_vdp_status(2);
				} while( !(c & 0x80) );
				v9968_write_vdp( 44, parts[j] );
			}
		}
	}
	v9968_wait_key();
	v9968_exit();
	return 0;
}
